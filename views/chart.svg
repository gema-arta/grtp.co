<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     width="250" height="150">

    <a xlink:href="https://gratipay.com/{{username}}/" target="_blank">
        <rect x="0" y="0" width="250" height="150" rx="3" fill="#396" />

        <g transform="translate(6.5 8.5) scale(0.017)">
            <circle cx="767" cy="640" r="767" fill="#fff" />
            <path d="M 763,1046 413,573 q -16,-22 -24.5,-59 -8.5,-37 6,-85 14.5,-48 61.5,-79 40,-26 83,-25.5 43,0.5 73.5,17.5 30.5,17 54.5,45 36,40 96,40 59,0 95,-40 24,-28 54.5,-45 30.5,-17 73.5,-17.5 43,-0.5 84,25.5 46,31 60.5,79 14.5,48 6,85 -8.5,37 -24.5,59 z" fill="#396" />
        </g>

        <g font-family="sans-serif" font-size="16" fill="#fff">
            <text x="40" y="25">{{username}}</text>
            <text x="240" y="25" text-anchor="end" id="receiving">${{receiving}}/wk</text>
        </g>

        <script><![CDATA[
        var total = {{ receiving }};
        var current = 0;
        var count = 0;
        var interval = 1000 / 30;
        var steps = Math.floor(800 / interval);
        var step = total / steps;
        var receiving = document.getElementById('receiving');

        (function animate() {
            current += step;

            receiving.innerHTML = '$' + current.toFixed(2) + '/wk';

            if (++count < steps) {
                setTimeout(animate, interval);
            }
        })();
        ]]></script>

        <g fill="#fff" shape-rendering="crispEdges">
            <animateTransform
                attributeName="transform"
                type="translate"
                from="0 142"
                to="0 0"
                dur="0.8" />
        {% set width = 234 / charts.length %}
        {% for chart in charts|reverse %}
            {% set height = chart.receipts / max_received * 107 %}
            <rect x="{{ 6 + loop.index * width }}" y="{{ 142 - height }}" width="{{ width }}" height="{{ height }}">
                <animateTransform
                    attributeName="transform"
                    type="scale"
                    from="1 0"
                    to="1 1"
                    dur="0.8" />
            </rect>
        {% endfor %}
        </g>
    </a>
</svg>

